# Datasets

Three datasets are provided with this benchmark. The details of each individual
dataset are given in the table below. 


| Dataset | EMPIAR ID    | Size (GB) | Description                                                                                                                                      |
|---------|--------------|-----------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| RELION tutorial | n/a | 8 | Small dataset from the Relion tutorial for rapid testing of setup. |
| Rabbit muscle aldolase  | 10338          | 1360      | Described in https://doi.org/10.1016/j.yjsbx.2020.100020 (processed by Martyn)      |
| Coronavirus-HKU1 haemagglutinin esterase | 10390          | ??        |  Tom's |

# Flowcharts

The PDFs in this directory show the pipeline flowcharts, as generated by Relion. Look in particular at page 2, where I have added some more annotation. The coloured boxes indicate individual jobs appropriate for benchmarking.

Note that the aldolase dataset requires a more complicated workflow than the simple tutorial dataset, and so there are multiple Refine3D jobs which vary in input and hence in hardware requirements.

The Relion workflow is quite complicated and can vary from project to project. At a high level, you are trying to do two things:  a) select out a consistent set of 2D particles to make your final reconstruction, and b) set some parameters to do with microscope optics and particle motion, which you can only model well when you have a partial solution. This all implies a certain amount of iteration, and different people/projects do it in different ways. The bottom line is that you will have several Refine3D jobs, and they will be different because they have different input (particles sets) and different convergence behaviour.

# Layout of each dataset

Each dataset contains the following:

- Most files are from a completed Relion project. These give the necessary input data for benchmarking runs.
These files are related to the jobs shown in the accompanying flowcharts. For the tutorial dataset, for example, subdirectory Refine3D/job028 contains most input and output files for the Refine3D job highlighted in red in the flowchart. Some input datafiles are in the subdirectory of the job which previously created them, and this is represented by arrows in the flowchart.
- The JobFiles subdirectory contains job control files in .star format for running the benchmarking jobs. Most parameters should be left untouched, as appropriate for the benchmark. Parameters in the Running section should be adjusted to specify the number of MPI tasks, threads, etc. Parameters in the Compute section could be adjusted to tune the job.
- The file slurm_template.sh is referenced from the job files, and provides a template for cluster submission. Variables enclosed in XXX...XXX are supplied by Relion prior to job submission. This template will need to be updated for the hardware platform being used.
- The script benchmark_runs.py is the main way of running the benchmarks. Select the benchmark of interest by editing at the top of the script, and run. The script assumes that Relion and the python API are on the PATH / PYTHONPATH.
